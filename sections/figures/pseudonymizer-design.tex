\begin{tikzpicture}[node distance=20pt]

\node [draw] (client) {Client};

\node [draw,
       right=of client] (proxy) {TLS proxy};

\node [draw,
       above right=of proxy,
       fill=black!20!gray] (service) {{\color{white} Service}};

\node [draw,
       fill=black!20!gray,
       minimum width=40pt,
       below right=of proxy] (ec2) {{\color{white} EC2}};

\node [draw,
       minimum width=40pt,
       below=0pt of ec2] (enclave) {Enclave};

\node [draw,
       right=of ec2,
       fill=black!20!gray] (backend) {{\color{white} Back end}};

\draw [-latex] (client.east) -- (proxy.west);

\draw [-latex] (proxy.east) -- (service.west)
      node [midway, right] {{\footnotesize Request (without address)}};

\draw [-latex] (proxy.east) -- (ec2.west)
      node [midway, right] {{\footnotesize Request (with address)}};

\draw [-latex] (ec2.east) -- (backend.west);

\end{tikzpicture}
